function showAll(){getEmployees(),document.getElementById("employeePage").style.display="block",document.getElementById("departmentsPage").style.display="none",document.getElementById("locationsPage").style.display="none",document.getElementById("allSearch").value=""}function showAllDepartments(){getDepartments(),document.getElementById("employeePage").style.display="none",document.getElementById("departmentsPage").style.display="block",document.getElementById("locationsPage").style.display="none",document.getElementById("allSearch").value=""}function showAllLocations(){getLocations(),document.getElementById("employeePage").style.display="none",document.getElementById("departmentsPage").style.display="none",document.getElementById("locationsPage").style.display="block",document.getElementById("allSearch").value=""}let currentEmployeeID,allEmployees,allDepartments,allLocations,currentDepartmentID;$(window).on("load",(function(){$("#preloader").length&&$("#preloader").fadeOut("slow",(function(){$(this).remove()}))})),$("#employeeEntry").click((function(){getEmployees(),fillEmployeeProfile()})),$("#navAll").click((function(){showAll(),document.getElementById("createEmployeeButton").innerHTML="Add employee",document.getElementById("createDepartmentButton").innerHTML="Add department",document.getElementById("createLocationButton").innerHTML="Add location"})),$("#navDepartments").click((function(){showAllDepartments(),document.getElementById("createEmployeeButton").innerHTML="Add employee",document.getElementById("createDepartmentButton").innerHTML="Add department",document.getElementById("createLocationButton").innerHTML="Add location"})),$("#navLocations").click((function(){showAllLocations(),document.getElementById("createEmployeeButton").innerHTML="Add employee",document.getElementById("createDepartmentButton").innerHTML="Add department",document.getElementById("createLocationButton").innerHTML="Add location"})),$(".deleteEmployee").click((function(){swal(`Are you sure you want to remove ${currentEmployeeName}?`,{icon:"warning",buttons:{cancel:"No",confirm:{text:"Yes",value:"confirm"}}}).then((e=>{if("confirm"===e)deleteEmployee(currentEmployeeID,currentEmployeeName)}))})),$("#formEmployee").submit((function(e){e.preventDefault(),createEmployee(),showAll(),document.getElementById("formEmployee").reset(),$("#createEmployeeModal").modal("hide")})),$("#createEmployeeButton").click((function(){getDepartmentList()})),$("#employeeEditForm").submit((function(e){e.preventDefault(),updateEmployee(),$("#employeeProfileEditModal").modal("hide")})),$("#formDepartment").submit((function(e){e.preventDefault(),createDepartment(),document.getElementById("formDepartment").reset(),$("#createDepartmentModal").modal("hide")})),$("#createDepartmentButton").click((function(){getLocationsList()})),$("#departmentSaveButton").click((function(){updateDepartment(),$("#departmentEditModal").modal("hide")})),$("#departmentCancelButton").click((function(){showAllDepartments()})),$("#formLocation").submit((function(e){e.preventDefault(),createLocation(),document.getElementById("formLocation").reset(),$("#createLocationModal").modal("hide")})),$("#locationsEditForm").submit((function(e){e.preventDefault(),updateLocation(),$("#locationEditModal").modal("hide")})),$("#locationCancelButton").click((function(){showLocations()})),$("#allSearchBar").submit((function(e){e.preventDefault(),searchAll()})),$("#allSearch").keyup((function(){searchAll()})),$(".backToAllButton").click((function(){showAll()})),$(".backToDepartmentsButton").click((function(){showAllDepartments()})),$(".backToLocationsButton").click((function(){showLocations()}));let currentLocationID,currentEmployeeName,currentDepartmentFilter=null,currentLocationFilter=null;function searchAll(){getEmployees(),getDepartments(),getLocations(),document.getElementById("employeePage").style.display="block",document.getElementById("departmentsPage").style.display="block",document.getElementById("locationsPage").style.display="block"}function getEmployees(){$.ajax({url:"libs/php/getAll.php",type:"GET",dataType:"json",data:{},success:function(e){document.getElementById("employeeList").innerHTML="",allEmployees=e.data,currentDepartmentFilter=null,showAllEmployees()}})}function showAllEmployees(){document.getElementById("employeeList").innerHTML="";for(const e of allEmployees){if(shouldShowEmployee(e)){const t=document.getElementById("employeeEntry").cloneNode(!0);document.getElementById("employeeList").appendChild(t),t.getElementsByClassName("listName")[0].innerText=`${e.firstName} ${e.lastName}`,t.getElementsByClassName("listJob")[0].innerText=e.jobTitle,t.getElementsByClassName("listDepartment")[0].innerText=e.department,document.getElementById("employeePage").style.display="block",t.setAttribute("id",`emp${e.id}`)}$(".employeeEntry").click((function(){fillEmployeeProfile($(this).closest("[id]").attr("id").replace("emp","")),$("#employeeProfileModal").modal("show")})),$(".employeeEditButton").click((function(e){fillEmployeeProfile($(this).closest("[id]").attr("id").replace("emp","")),$("#employeeProfileEditModal").modal("show"),e.stopPropagation()})),$(".employeeDeleteButton").click((function(e){const t=$(this).closest("[id]").attr("id").replace("emp",""),n=$(this).parents("tr").find(".listName").text();swal(`Are you sure you want to remove ${n}?`,{icon:"warning",buttons:{cancel:"No",confirm:{text:"Yes",value:"confirm"}}}).then((e=>{if("confirm"===e)deleteEmployee(t,n)})),e.stopPropagation()}))}}function shouldShowEmployee(e){const t=document.getElementById("allSearch").value.toLowerCase();return!(!e.firstName.toLowerCase().includes(t)&&!e.lastName.toLowerCase().includes(t))||(!!e.department.toLowerCase().includes(t)||(!!e.location.toLowerCase().includes(t)||(!!e.email.toLowerCase().includes(t)||!!e.jobTitle.toLowerCase().includes(t))))}function getDepartments(){$.ajax({url:"libs/php/getAllDepartments.php",type:"GET",dataType:"json",data:{},success:function(e){document.getElementById("departmentsList").innerHTML="",allDepartments=e.data,currentLocationFilter=null,showDepartments()}})}function showDepartments(){document.getElementById("departmentsList").innerHTML="";for(const e of allDepartments)if(shouldShowDepartment(e)){const t=document.getElementById("departmentsEntry").cloneNode(!0);document.getElementById("departmentsList").appendChild(t),t.getElementsByClassName("departmentsName")[0].innerText=e.name,t.getElementsByClassName("locationName")[0].innerText=e.location,t.getElementsByClassName("numOfEmployees")[0].innerText=e.num_of_employees,t.getElementsByClassName("locationID")[0].innerText=e.locationID,t.setAttribute("id",`dep${e.id}`)}$(".departmentEditButton").click((function(){const e=$(this).closest("[id]").attr("id").replace("dep",""),t=$(this).parents("tr").children(".departmentsName").text(),n=$(this).parents("tr").children(".locationID").text();currentDepartmentID=e,document.getElementById("departmentNameEdit").value=t,document.getElementById("departmentEditHeader").innerText=`Editing ${t}`,getLocationsListEdit(n)})),$(".departmentDeleteButton").click((function(){const e=$(this).closest("[id]").attr("id").replace("dep",""),t=$(this).parents("tr").children(".departmentsName").text();$(this).parents("tr").children(".numOfEmployees").text()>0?swal(`There are still employees in ${t}; you can not delete it.`,{icon:"error"}):swal(`Are you sure you want to delete ${t}?`,{icon:"warning",buttons:{cancel:"No",confirm:{text:"Yes",value:"confirm"}}}).then((n=>{if("confirm"===n)deleteDepartment(e,t)}))}))}function shouldShowDepartment(e){const t=document.getElementById("allSearch").value.toLowerCase();return!!e.name.toLowerCase().includes(t)||!!e.location.toLowerCase().includes(t)}function getLocations(){$.ajax({url:"libs/php/getAllLocations.php",type:"GET",dataType:"json",data:{},success:function(e){document.getElementById("locationsList").innerHTML="",allLocations=e.data,currentLocationFilter=null,showLocations()}})}function showLocations(){document.getElementById("locationsList").innerHTML="";for(const e of allLocations)if(shouldShowLocation(e)){const t=document.getElementById("locationsEntry").cloneNode(!0);document.getElementById("locationsList").appendChild(t),t.getElementsByClassName("locationsName")[0].innerText=e.name,t.getElementsByClassName("numOfDepts")[0].innerText=e.num_of_depts,t.setAttribute("id",`loc${e.id}`)}$(".locationEditButton").click((function(){const e=$(this).closest("[id]").attr("id").replace("loc",""),t=$(this).parents("tr").children(".locationsName").text();currentLocationID=e,document.getElementById("locationNameEdit").value=t,document.getElementById("locationEditHeader").innerText=`Editing ${t}`})),$(".locationDeleteButton").click((function(){const e=$(this).closest("[id]").attr("id").replace("loc",""),t=$(this).parents("tr").children(".locationsName").text();$(this).parents("tr").children(".numOfDepts").text()>0?swal(`There are still departments in ${t}; you can not delete it.`,{icon:"error"}):swal(`Are you sure you want to delete ${t}?`,{icon:"warning",buttons:{cancel:"No",confirm:{text:"Yes",value:"confirm"}}}).then((n=>{if("confirm"===n)deleteLocation(e,t)}))}))}function shouldShowLocation(e){const t=document.getElementById("allSearch").value;return!!e.name.toLowerCase().includes(t.toLowerCase())}function fillEmployeeProfile(e){$.ajax({url:"libs/php/getPersonnelByID.php",type:"GET",dataType:"json",data:{id:e},success:function(e){document.getElementById("employeeName").innerText=`${e.data.personnel[0].firstName} ${e.data.personnel[0].lastName}`,document.getElementById("employeeLocation").innerText=e.data.personnel[0].location,document.getElementById("employeeEmail").innerText=e.data.personnel[0].email,document.getElementById("employeeDepartment").innerText=e.data.personnel[0].department,document.getElementById("employeeLocation").innerText=e.data.personnel[0].location,document.getElementById("employeeJobTitle").innerText=e.data.personnel[0].jobTitle,document.getElementById("employeeFirstNameEdit").value=e.data.personnel[0].firstName,document.getElementById("employeeLastNameEdit").value=e.data.personnel[0].lastName,document.getElementById("employeeEmailEdit").value=e.data.personnel[0].email,document.getElementById("employeeJobTitleEdit").value=e.data.personnel[0].jobTitle,document.getElementById("employeeNameEdit").innerText=`Editing ${e.data.personnel[0].firstName} ${e.data.personnel[0].lastName}`,currentEmployeeName=`${e.data.personnel[0].firstName} ${e.data.personnel[0].lastName}`,currentEmployeeID=e.data.personnel[0].id,getDepartmentListEdit(e.data.personnel[0].departmentID)}})}function deleteEmployee(e,t){$.ajax({url:"libs/php/deletePersonnelByID.php",type:"POST",dataType:"json",data:{id:e},success:function(e){"ok"==e.status.name?(swal(`You have successfully removed ${t}.`,{icon:"success"}),showAll(),$("#employeeProfileModal").modal("hide")):(swal("Something has gone wrong. Please try again.",{icon:"error"}),showAll())}})}function createEmployee(){$.ajax({url:"libs/php/insertPersonnel.php",type:"POST",dataType:"json",data:{firstName:document.getElementById("formFirstName").value,lastName:document.getElementById("formLastName").value,jobTitle:document.getElementById("formJobTitle").value,email:document.getElementById("formEmail").value,departmentID:document.getElementById("formDepartmentDropdown").value},success:function(e){fillEmployeeProfile(e.data),$("#employeeProfileModal").modal("show")}})}function deleteDepartment(e,t){$.ajax({url:"libs/php/deleteDepartmentByID.php",type:"POST",datatype:"json",data:{id:e},success:function(e){"ok"==e.status.name?(getDepartments(),swal(`You have successfully deleted ${t}.`,{icon:"success"})):swal(`There are still employees in ${t}; you can not delete it.`,{icon:"error"})}})}function createDepartment(){$.ajax({url:"libs/php/insertDepartment.php",type:"POST",datatype:"json",data:{name:document.getElementById("formDepartmentName").value,locationID:document.getElementById("formLocationDropdown").value},success:function(e){showAllDepartments()}})}function deleteLocation(e,t){$.ajax({url:"libs/php/deleteLocationByID.php",type:"POST",datatype:"json",data:{id:e},success:function(e){"ok"==e.status.name?(showAllLocations(),swal(`You have successfully deleted ${t}.`,{icon:"success"})):swal(`There are still departments in ${t}; you can not delete it.`,{icon:"error"})}})}function createLocation(){$.ajax({url:"libs/php/insertLocation.php",type:"POST",datatype:"json",data:{name:document.getElementById("formLocationName").value},success:function(e){showAllLocations()}})}function getLocationsList(){$.ajax({url:"libs/php/getAllLocations.php",type:"POST",datatype:"json",data:{},success:function(e){document.getElementById("formLocationDropdown").innerHTML="";const t=e.data,n=document.getElementById("formLocationDropdown");t.sort(),t.forEach((function(e){const t=document.createElement("option");t.value=e.id,t.innerText=e.name,n.appendChild(t)}))}})}function getDepartmentList(){$.ajax({url:"libs/php/getAllDepartments.php",type:"POST",datatype:"json",data:{},success:function(e){document.getElementById("formDepartmentDropdown").innerHTML="",document.getElementById("formDepartmentDropdownEdit").innerHTML="";const t=e.data,n=document.getElementById("formDepartmentDropdown");t.sort(),t.forEach((function(e){const t=document.createElement("option");t.value=e.id,t.innerText=e.name,n.appendChild(t)}));const o=document.getElementById("formDepartmentDropdownEdit");t.forEach((function(e){const t=document.createElement("option");t.value=e.id,t.innerText=e.name,o.appendChild(t)}))}})}function getDepartmentListEdit(e){$.ajax({url:"libs/php/getAllDepartments.php",type:"POST",datatype:"json",data:{},success:function(t){document.getElementById("formDepartmentDropdownEdit").innerHTML="";const n=t.data;n.sort();const o=document.getElementById("formDepartmentDropdownEdit");n.forEach((function(e){const t=document.createElement("option");t.value=e.id,t.innerText=e.name,o.appendChild(t)})),document.getElementById("formDepartmentDropdownEdit").value=e}})}function updateEmployee(){$.ajax({url:"libs/php/updatePersonnelByID.php",type:"POST",dataType:"json",data:{firstName:document.getElementById("employeeFirstNameEdit").value,lastName:document.getElementById("employeeLastNameEdit").value,email:document.getElementById("employeeEmailEdit").value,jobTitle:document.getElementById("employeeJobTitleEdit").value,departmentID:document.getElementById("formDepartmentDropdownEdit").value,id:currentEmployeeID},success:function(e){showAll()}})}function getLocationsListEdit(e){$.ajax({url:"libs/php/getAllLocations.php",type:"POST",datatype:"json",data:{},success:function(t){document.getElementById("formLocationDropdownEdit").innerHTML="";const n=t.data,o=document.getElementById("formLocationDropdownEdit");n.sort(),n.forEach((function(e){const t=document.createElement("option");t.value=e.id,t.innerText=e.name,o.appendChild(t)})),document.getElementById("formLocationDropdownEdit").value=e}})}function updateDepartment(){$.ajax({url:"libs/php/updateDepartmentByID.php",type:"POST",dataType:"json",data:{name:document.getElementById("departmentNameEdit").value,locationID:document.getElementById("formLocationDropdownEdit").value,id:currentDepartmentID},success:function(e){getDepartments()}})}function updateLocation(){$.ajax({url:"libs/php/updateLocationByID.php",type:"POST",dataType:"json",data:{name:document.getElementById("locationNameEdit").value,id:currentLocationID},success:function(e){showAllLocations()}})}getDepartments(),getEmployees(),getLocations();