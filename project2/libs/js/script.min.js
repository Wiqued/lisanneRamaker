function showAll(){getEmployees(),document.getElementById("employeePage").style.display="block",document.getElementById("employeeProfile").style.display="none",document.getElementById("departmentsPage").style.display="none",document.getElementById("locationsPage").style.display="none",document.getElementById("createEmployee").style.display="none",document.getElementById("createDepartment").style.display="none",document.getElementById("createLocation").style.display="none",document.getElementById("employeeProfileEdit").style.display="none",document.getElementById("departmentEdit").style.display="none",document.getElementById("locationsEdit").style.display="none"}function showAllDepartments(){getDepartments(),document.getElementById("employeePage").style.display="none",document.getElementById("employeeProfile").style.display="none",document.getElementById("departmentsPage").style.display="block",document.getElementById("locationsPage").style.display="none",document.getElementById("createEmployee").style.display="none",document.getElementById("createDepartment").style.display="none",document.getElementById("createLocation").style.display="none",document.getElementById("employeeProfileEdit").style.display="none",document.getElementById("departmentEdit").style.display="none",document.getElementById("locationsEdit").style.display="none"}let currentEmployeeID,allEmployees,allDepartments,allLocations,currentDepartmentID;$("#searchForm").submit((function(e){e.preventDefault()})),$("#employeeEntry").click((function(){showEmployeeProfile()})),$("#navAll").click((function(){showAll(),document.getElementById("createEmployeeButton").innerHTML="Add employee",document.getElementById("createDepartmentButton").innerHTML="Add department",document.getElementById("createLocationButton").innerHTML="Add location"})),$("#navDepartments").click((function(){showAllDepartments(),document.getElementById("createEmployeeButton").innerHTML="Add employee",document.getElementById("createDepartmentButton").innerHTML="Add department",document.getElementById("createLocationButton").innerHTML="Add location"})),$("#navLocations").click((function(){getLocations(),document.getElementById("createEmployeeButton").innerHTML="Add employee",document.getElementById("createDepartmentButton").innerHTML="Add department",document.getElementById("createLocationButton").innerHTML="Add location"})),$(".deleteEmployee").click((function(){swal("Are you sure you want to delete this employee?",{icon:"warning",buttons:{cancel:"Cancel",confirm:{text:"Confirm",value:"confirm"}}}).then((e=>{if("confirm"===e)swal("You have successfully removed the employee.",{icon:"success"}),deleteEmployee(currentEmployeeID)}))})),$("#formEmployee").submit((function(e){e.preventDefault(),createEmployee(),document.getElementById("formEmployee").reset()})),$("#createEmployeeButton").click((function(){let e=document.getElementById("createEmployee"),t=document.getElementById("createEmployeeButton");getDepartmentList(),"block"==e.style.display?(t.innerHTML="Add employee",e.style.display="none"):(t.innerHTML="Hide",e.style.display="block")})),$("#employeeEditButton").click((function(){document.getElementById("employeeProfile").style.display="none",document.getElementById("employeeProfileEdit").style.display="block"})),$("#employeeSaveButton").click((function(){updateEmployee(),document.getElementById("employeeProfile").style.display="block",document.getElementById("employeeProfileEdit").style.display="none"})),$("#employeeCancelButton").click((function(){showEmployeeProfile(currentEmployeeID),document.getElementById("employeeProfileEdit").style.display="none"})),$("#formDepartment").submit((function(e){e.preventDefault(),createDepartment(),document.getElementById("formDepartment").reset()})),$("#createDepartmentButton").click((function(){let e=document.getElementById("createDepartment"),t=document.getElementById("createDepartmentButton");getLocationsList(),"block"==e.style.display?(t.innerHTML="Add department",e.style.display="none"):(t.innerHTML="Hide",e.style.display="block")})),$("#departmentSaveButton").click((function(){updateDepartment(),document.getElementById("departmentsPage").style.display="block",document.getElementById("departmentEdit").style.display="none"})),$("#departmentCancelButton").click((function(){showAllDepartments()})),$("#deleteLocation").click((function(){confirm("Are you sure you want to delete this location?")&&deleteLocation()})),$("#formLocation").submit((function(e){e.preventDefault(),createLocation(),document.getElementById("formLocation").reset()})),$("#createLocationButton").click((function(){let e=document.getElementById("createLocation"),t=document.getElementById("createLocationButton");"block"==e.style.display?(t.innerHTML="Add location",e.style.display="none"):(t.innerHTML="Hide",e.style.display="block")})),$("#locationSaveButton").click((function(){updateLocation(),document.getElementById("locationsPage").style.display="block",document.getElementById("locationsEdit").style.display="none"})),$("#locationCancelButton").click((function(){showLocations()})),$("#allSearchBar").submit((function(e){e.preventDefault(),showAllEmployees()})),$("#departmentSearchBar").submit((function(e){e.preventDefault(),showDepartments()})),$("#locationSearchBar").submit((function(e){e.preventDefault(),showLocations()})),$(".backToAllButton").click((function(){showAll()})),$(".backToDepartmentsButton").click((function(){showAllDepartments()})),$(".backToLocationsButton").click((function(){showLocations()}));let currentLocationID,currentDepartmentFilter=null,currentLocationFilter=null;function getEmployees(){$.ajax({url:"libs/php/getAll.php",type:"GET",dataType:"json",data:{},success:function(e){document.getElementById("employeeList").innerHTML="",allEmployees=e.data,document.getElementById("allEmployeeSearch").value="",currentDepartmentFilter=null,showAllEmployees()}})}function showAllEmployees(){document.getElementById("employeeList").innerHTML="";for(const e of allEmployees)if(shouldShowEmployee(e)){const t=document.getElementById("employeeEntry").cloneNode(!0);document.getElementById("employeeList").appendChild(t),t.getElementsByClassName("listName")[0].innerText=`${e.firstName} ${e.lastName}`,t.getElementsByClassName("listJob")[0].innerText=e.jobTitle,t.getElementsByClassName("listDepartment")[0].innerText=e.department,t.getElementsByClassName("listLocation")[0].innerText=e.location,document.getElementById("employeePage").style.display="block",document.getElementById("employeeProfile").style.display="none",$(t).click((function(){showEmployeeProfile(e.id)}))}}function shouldShowEmployee(e){if(null!=currentDepartmentFilter&&currentDepartmentFilter!=e.departmentID)return!1;const t=document.getElementById("allEmployeeSearch").value;return!(!e.firstName.toLowerCase().includes(t.toLowerCase())&&!e.lastName.toLowerCase().includes(t.toLowerCase()))}function getDepartments(){$.ajax({url:"libs/php/getAllDepartments.php",type:"GET",dataType:"json",data:{},success:function(e){document.getElementById("departmentsList").innerHTML="",allDepartments=e.data,document.getElementById("allDepartmentSearch").value="",currentLocationFilter=null,showDepartments()}})}function showDepartments(){document.getElementById("departmentsList").innerHTML="";for(const e of allDepartments)if(shouldShowDepartment(e)){const t=document.getElementById("departmentsEntry").cloneNode(!0);document.getElementById("departmentsList").appendChild(t),t.getElementsByClassName("departmentsName")[0].innerText=e.name,t.getElementsByClassName("locationName")[0].innerText=e.location,t.getElementsByClassName("employeeCount")[0].innerText=`Show ${e.num_of_employees} employee(s)`,$(t.getElementsByClassName("employeeCount")[0]).click((function(){currentDepartmentFilter=e.id,showAllEmployees(),document.getElementById("departmentsPage").style.display="none"})),$(t.getElementsByClassName("deleteDepartment")[0]).click((function(){swal("Are you sure you want to delete this department?",{icon:"warning",buttons:{cancel:"Cancel",confirm:{text:"Confirm",value:"confirm"}}}).then((t=>{if("confirm"===t)deleteDepartment(e.id)}))})),$(t.getElementsByClassName("departmentEditButton")[0]).click((function(){currentDepartmentID=e.id,document.getElementById("departmentsPage").style.display="none",document.getElementById("departmentEdit").style.display="block",document.getElementById("departmentNameEdit").value=e.name,getLocationsListEdit(e.locationID)}))}}function shouldShowDepartment(e){if(null!=currentLocationFilter&&currentLocationFilter!=e.locationID)return!1;const t=document.getElementById("allDepartmentSearch").value;return!!e.name.toLowerCase().includes(t.toLowerCase())}function getLocations(){$.ajax({url:"libs/php/getAllLocations.php",type:"GET",dataType:"json",data:{},success:function(e){document.getElementById("locationsList").innerHTML="",allLocations=e.data,document.getElementById("allLocationSearch").value="",currentLocationFilter=null,showLocations()}})}function showLocations(){document.getElementById("locationsList").innerHTML="";for(const e of allLocations)if(shouldShowLocation(e)){const t=document.getElementById("locationsEntry").cloneNode(!0);document.getElementById("locationsList").appendChild(t),t.getElementsByClassName("locationsName")[0].innerText=e.name,t.getElementsByClassName("departmentCount")[0].innerText=`Show ${e.num_of_depts} department(s)`,$(t.getElementsByClassName("departmentCount")[0]).click((function(){currentLocationFilter=e.id,console.log(currentLocationFilter),showDepartments(),document.getElementById("locationsPage").style.display="none",document.getElementById("departmentsPage").style.display="block"})),$(t.getElementsByClassName("deleteLocation")[0]).click((function(){swal("Are you sure you want to delete this location?",{icon:"warning",buttons:{cancel:"Cancel",confirm:{text:"Confirm",value:"confirm"}}}).then((t=>{if("confirm"===t)deleteLocation(e.id)}))})),$(t.getElementsByClassName("locationEditButton")[0]).click((function(){currentLocationID=e.id,document.getElementById("locationsPage").style.display="none",document.getElementById("locationsEdit").style.display="block",document.getElementById("locationNameEdit").value=e.name}))}document.getElementById("employeePage").style.display="none",document.getElementById("employeeProfile").style.display="none",document.getElementById("departmentsPage").style.display="none",document.getElementById("locationsPage").style.display="block",document.getElementById("createEmployee").style.display="none",document.getElementById("createDepartment").style.display="none",document.getElementById("createLocation").style.display="none",document.getElementById("employeeProfileEdit").style.display="none",document.getElementById("departmentEdit").style.display="none",document.getElementById("locationsEdit").style.display="none"}function shouldShowLocation(e){const t=document.getElementById("allLocationSearch").value;return!!e.name.toLowerCase().includes(t.toLowerCase())}function showEmployeeProfile(e){$.ajax({url:"libs/php/getPersonnelByID.php",type:"GET",dataType:"json",data:{id:e},success:function(e){document.getElementById("employeeName").innerText=`${e.data.personnel[0].firstName} ${e.data.personnel[0].lastName}`,document.getElementById("employeeLocation").innerText=e.data.personnel[0].location,document.getElementById("employeeEmail").innerText=e.data.personnel[0].email,document.getElementById("employeeDepartment").innerText=e.data.personnel[0].department,document.getElementById("employeeLocation").innerText=e.data.personnel[0].location,document.getElementById("employeeJobTitle").innerText=e.data.personnel[0].jobTitle,document.getElementById("employeeFirstNameEdit").value=e.data.personnel[0].firstName,document.getElementById("employeeLastNameEdit").value=e.data.personnel[0].lastName,document.getElementById("employeeEmailEdit").value=e.data.personnel[0].email,document.getElementById("employeeJobTitleEdit").value=e.data.personnel[0].jobTitle,currentEmployeeID=e.data.personnel[0].id,getDepartmentListEdit(e.data.personnel[0].departmentID),document.getElementById("employeePage").style.display="none",document.getElementById("employeeProfile").style.display="block",document.getElementById("departmentsPage").style.display="none",document.getElementById("locationsPage").style.display="none",document.getElementById("createEmployee").style.display="none",document.getElementById("createDepartment").style.display="none",document.getElementById("createLocation").style.display="none",document.getElementById("employeeProfileEdit").style.display="none",document.getElementById("departmentEdit").style.display="none",document.getElementById("locationsEdit").style.display="none"}})}function deleteEmployee(e){$.ajax({url:"libs/php/deletePersonnelByID.php",type:"POST",dataType:"json",data:{id:e},success:function(e){showAll()}})}function createEmployee(){$.ajax({url:"libs/php/insertPersonnel.php",type:"POST",dataType:"json",data:{firstName:document.getElementById("formFirstName").value,lastName:document.getElementById("formLastName").value,jobTitle:document.getElementById("formJobTitle").value,email:document.getElementById("formEmail").value,departmentID:document.getElementById("formDepartmentDropdown").value},success:function(e){showEmployeeProfile(e.data)}})}function deleteDepartment(e){$.ajax({url:"libs/php/deleteDepartmentByID.php",type:"POST",datatype:"json",data:{id:e},success:function(e){"ok"==e.status.name?(getDepartments(),swal("You have successfully deleted the department.",{icon:"success"})):swal("There are still employees in that department; you can not delete it.",{icon:"error"})}})}function createDepartment(){$.ajax({url:"libs/php/insertDepartment.php",type:"POST",datatype:"json",data:{name:document.getElementById("formDepartmentName").value,locationID:document.getElementById("formLocationDropdown").value},success:function(e){getDepartments()}})}function deleteLocation(e){$.ajax({url:"libs/php/deleteLocationByID.php",type:"POST",datatype:"json",data:{id:e},success:function(e){"ok"==e.status.name?(getLocations(),swal("You have successfully deleted the location.",{icon:"success"})):swal("There are still departments in that location; you can not delete it.",{icon:"error"})}})}function createLocation(){$.ajax({url:"libs/php/insertLocation.php",type:"POST",datatype:"json",data:{name:document.getElementById("formLocationName").value},success:function(e){getLocations()}})}function getLocationsList(){$.ajax({url:"libs/php/getAllLocations.php",type:"POST",datatype:"json",data:{},success:function(e){document.getElementById("formLocationDropdown").innerHTML="";const t=e.data,n=document.getElementById("formLocationDropdown");t.sort(),t.forEach((function(e){const t=document.createElement("option");t.value=e.id,t.innerText=e.name,n.appendChild(t)}))}})}function getDepartmentList(){$.ajax({url:"libs/php/getAllDepartments.php",type:"POST",datatype:"json",data:{},success:function(e){document.getElementById("formDepartmentDropdown").innerHTML="",document.getElementById("formDepartmentDropdownEdit").innerHTML="";const t=e.data,n=document.getElementById("formDepartmentDropdown");t.sort(),t.forEach((function(e){const t=document.createElement("option");t.value=e.id,t.innerText=e.name,n.appendChild(t)}));const o=document.getElementById("formDepartmentDropdownEdit");t.forEach((function(e){const t=document.createElement("option");t.value=e.id,t.innerText=e.name,o.appendChild(t)}))}})}function getDepartmentListEdit(e){$.ajax({url:"libs/php/getAllDepartments.php",type:"POST",datatype:"json",data:{},success:function(t){document.getElementById("formDepartmentDropdownEdit").innerHTML="";const n=t.data;n.sort();const o=document.getElementById("formDepartmentDropdownEdit");n.forEach((function(e){const t=document.createElement("option");t.value=e.id,t.innerText=e.name,o.appendChild(t)})),document.getElementById("formDepartmentDropdownEdit").value=e}})}function updateEmployee(){$.ajax({url:"libs/php/updatePersonnelByID.php",type:"POST",dataType:"json",data:{firstName:document.getElementById("employeeFirstNameEdit").value,lastName:document.getElementById("employeeLastNameEdit").value,email:document.getElementById("employeeEmailEdit").value,jobTitle:document.getElementById("employeeJobTitleEdit").value,departmentID:document.getElementById("formDepartmentDropdownEdit").value,id:currentEmployeeID},success:function(e){showEmployeeProfile(currentEmployeeID)}})}function getLocationsListEdit(e){$.ajax({url:"libs/php/getAllLocations.php",type:"POST",datatype:"json",data:{},success:function(t){document.getElementById("formLocationDropdownEdit").innerHTML="";const n=t.data,o=document.getElementById("formLocationDropdownEdit");n.sort(),n.forEach((function(e){const t=document.createElement("option");t.value=e.id,t.innerText=e.name,o.appendChild(t)})),document.getElementById("formLocationDropdownEdit").value=e}})}function updateDepartment(){$.ajax({url:"libs/php/updateDepartmentByID.php",type:"POST",dataType:"json",data:{name:document.getElementById("departmentNameEdit").value,locationID:document.getElementById("formLocationDropdownEdit").value,id:currentDepartmentID},success:function(e){showDepartments()}})}function updateLocation(){$.ajax({url:"libs/php/updateLocationByID.php",type:"POST",dataType:"json",data:{name:document.getElementById("locationNameEdit").value,id:currentLocationID},success:function(e){showLocations()}})}getDepartments(),getEmployees();